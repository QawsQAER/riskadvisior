<%@ page language="java" contentType="text/html; charset=ISO-8859-1"
	pageEncoding="ISO-8859-1"%>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>Risk Advisor</title>
<%@  include file="./templates/includes.jsp"%></head>
<body>
	<%@  include file="./templates/header.jsp"%>
	<!-- Main part -->
	<div class="container">
		<div>
			<div class="well">
				<table class="table table-bordered">
					<th>Funding risks</th>
					<th>Concentration on few large customers</th>
					<th>Competition risks</th>
					<tr>
						<td>
							<label class="checkbox-inline">
							  <input type="checkbox" class="check" value="capital"> capital
							</label>
						</td>
						<td>
							<label class="checkbox-inline">
							  <input type="checkbox" class="check1" value="customer"> customer
							</label>
						</td>
						<td>
							<label class="checkbox-inline">
							  <input type="checkbox" class="check2" value="competition"> competition
							</label>
						</td>
					</tr>
					<tr>
						<td>
							<label class="checkbox-inline">
							  <input type="checkbox" class="check" value="raise capital"> raise capital
							</label>
						</td>
						<td>
							<label class="checkbox-inline">
							  <input type="checkbox" class="check1" value="key customer"> key customer
							</label>
						</td>
						<td>
							<label class="checkbox-inline">
							  <input type="checkbox" class="check2" value="highly competitive"> highly competitive
							</label>
						</td>
					</tr>
					<tr>
						<td>
							<label class="checkbox-inline">
							  <input type="checkbox" class="check" value="funding risk"> funding risk
							</label>
						</td>
						<td>
							<label class="checkbox-inline">
							  <input type="checkbox" class="check1" value="large customer"> large customer
							</label>
						</td>
						<td>
							<label class="checkbox-inline">
							  <input type="checkbox" class="check2" value="less competitive"> less competitive
							</label>
						</td>
					</tr>
					<tr>
						<td>
							<label class="checkbox-inline">
							  <input type="checkbox" class="check" value="capital resource"> capital resource
							</label>
						</td>
						<td>
						</td>
						<td>
							<label class="checkbox-inline">
							  <input type="checkbox" class="check2" value="our competitors include"> our competitors include
							</label>
						</td>
					</tr>
					<tr>
						<td>
							<label class="checkbox-inline">
							  <input type="checkbox" class="check" value="the amount of capital"> the amount of capital
							</label>
						</td>
						<td>
						</td>
						<td>
							<label class="checkbox-inline">
							  <input type="checkbox" class="check2" value="many competitors"> many competitors
							</label>
						</td>
					</tr>
					<tr>
						<td>
							<label class="checkbox-inline">
							  <input type="checkbox" class="check" value="capital expenditure"> capital expenditure
							</label>
						</td>
						<td>
						</td>
						<td>
							<label class="checkbox-inline">
							  <input type="checkbox" class="check2" value="compete with"> compete with
							</label>
						</td>
					</tr>
					<tr>
						<td>
							<label class="checkbox-inline">
							  <input type="checkbox" class="check" value="additional capital"> additional capital
							</label>
						</td>
						<td>
						</td>
						<td>
							<label class="checkbox-inline">
							  <input type="checkbox" class="check2" value="competes with"> competes with
							</label>
						</td>
					</tr>
					<tr>
						<td>
							<label class="checkbox-inline">
							  <input type="checkbox" class="check" value="sufficient capital"> sufficient capital
							</label>
						</td>
						<td>
						</td>
						<td>
							<label class="checkbox-inline">
							  <input type="checkbox" class="check2" value="competition in existing and new market"> competition in existing and new market
							</label>
						</td>
					</tr>
					<tr>
						<td>
							<label class="checkbox-inline">
							  <input type="checkbox" class="check" value="credit rat"> credit rat
							</label>
						</td>
						<td>
						</td>
						<td>
							<label class="checkbox-inline">
							  <input type="checkbox" class="check2" value="changes in competition"> changes in competition
							</label>
						</td>
					</tr>
					<tr>
						<td>
							<label class="checkbox-inline">
							  <input type="checkbox" class="check" value="borrowing cost"> borrowing cost
							</label>
						</td>
						<td>
						</td>
						<td>
							<label class="checkbox-inline">
							  <input type="checkbox" class="check2" value="change in competition"> change in competition
							</label>
						</td>
					</tr>
					<tr>
						<td>
							<label class="checkbox-inline">
							  <input type="checkbox" class="check" value="interest expense"> interest expense
							</label>
						</td>
						<td>
						</td>
						<td>
							<label class="checkbox-inline">
							  <input type="checkbox" class="check2" value="compete against"> compete against
							</label>
						</td>
					</tr>
					<tr>
						<td>
						</td>
						<td>
						</td>
						<td>
							<label class="checkbox-inline">
							  <input type="checkbox" class="check2" value="competes against"> competes against
							</label>
						</td>
					</tr>
					<tr>
						<td>
						</td>
						<td>
						</td>
						<td>
							<label class="checkbox-inline">
							  <input type="checkbox" class="check2" value="compete in"> compete in
							</label>
						</td>
					</tr>
					<tr>
						<td>
						</td>
						<td>
						</td>
						<td>
							<label class="checkbox-inline">
							  <input type="checkbox" class="check2" value="competes in"> competes in
							</label>
						</td>
					</tr>
					<tr>
						<td>
						</td>
						<td>
						</td>
						<td>
							<label class="checkbox-inline">
							  <input type="checkbox" class="check2" value="significant competition"> significant competition
							</label>
						</td>
					</tr>
					<tr>
						<td>
						</td>
						<td>
						</td>
						<td>
							<label class="checkbox-inline">
							  <input type="checkbox" class="check2" value="competitor"> competitor
							</label>
						</td>
					</tr>
					<tr>
						<td>
						</td>
						<td>
						</td>
						<td>
							<label class="checkbox-inline">
							  <input type="checkbox" class="check2" value="intense competition"> intense competition
							</label>
						</td>
					</tr>
					<tr>
						<td>
						</td>
						<td>
						</td>
						<td>
							<label class="checkbox-inline">
							  <input type="checkbox" class="check2" value="competitive pressure"> competitive pressure
							</label>
						</td>
					</tr>
				</table>
			</div>
			<h2>Selected Companies</h2>
			<div class="well">
				<ul id="comList">
				</ul>
			</div>
			<input type="text" class="form-control" id="inputCompany" placeholder="Company Name">
			<input type="hidden" id="companys" value='{"companys":[]}'>
			<input type="hidden" id="preferences" value='{"keywords":[{
		            "category": "Funding risks",
		            "factors": [
		            ]
	        	},
		        {
		            "category": "Concentration on few large customers",
		            "factors": [  
		            ]
		        },
		        {
		            "category": "Competition risks",
		            "factors": [  
		            ]
		        }
		        ]
		    }'>
		    <br>
			<button type="submit" id="appendComp" class="btn btn-success">Add</button>
			<button type="submit" id="getUserPre" class="btn btn-primary">Analyze</button>
			<br>
		</div>
	</div>
	<script>
		$('.check').change(function () {
			if($(this).is(":checked")==true) {
				var json = JSON.parse($('#preferences').val());
				for(cgory in json.keywords) {
					if(json.keywords[cgory].category == 'Funding risks') {
						json.keywords[cgory].factors.push($(this).val());
					}
				}
				$('#preferences').val(JSON.stringify(json));
			} else {
				var json = JSON.parse($('#preferences').val());
				for(cgory in json.keywords) {
					if(json.keywords[cgory].category == 'Funding risks') {
						for(ckeys in json.keywords[cgory].factors)
							if(json.keywords[cgory].factors[ckeys] == $(this).val())
							json.keywords[cgory].factors.splice(ckeys,1);
					}
				}
				$('#preferences').val(JSON.stringify(json));
			}
		});
		$('.check1').change(function () {
			if($(this).is(":checked")==true) {
				var json = JSON.parse($('#preferences').val());
				for(cgory in json.keywords) {
					if(json.keywords[cgory].category == 'Concentration on few large customers') {
						json.keywords[cgory].factors.push($(this).val());
					}
				}
				$('#preferences').val(JSON.stringify(json));
			} else {
				var json = JSON.parse($('#preferences').val());
				for(cgory in json.keywords) {
					if(json.keywords[cgory].category == 'Concentration on few large customers') {
						for(ckeys in json.keywords[cgory].factors)
							if(json.keywords[cgory].factors[ckeys] == $(this).val())
							json.keywords[cgory].factors.splice(ckeys,1);
					}
				}
				$('#preferences').val(JSON.stringify(json));
			}
		});
		$('.check2').change(function () {
			if($(this).is(":checked")==true) {
				var json = JSON.parse($('#preferences').val());
				for(cgory in json.keywords) {
					if(json.keywords[cgory].category == 'Competition risks') {
						json.keywords[cgory].factors.push($(this).val());
					}
				}
				$('#preferences').val(JSON.stringify(json));
			} else {
				var json = JSON.parse($('#preferences').val());
				for(cgory in json.keywords) {
					if(json.keywords[cgory].category == 'Competition risks') {
						for(ckeys in json.keywords[cgory].factors)
							if(json.keywords[cgory].factors[ckeys] == $(this).val())
							json.keywords[cgory].factors.splice(ckeys,1);
					}
				}
				$('#preferences').val(JSON.stringify(json));
			}
		});
		
		$('#appendComp').click(function () {
			var json = JSON.parse($('#companys').val());
			json.companys.push($('#inputCompany').val());
			$('#companys').val(JSON.stringify(json));
			$('#comList').append("<li>" + $('#inputCompany').val() + "</li>")
		});
	
		$('#getUserPre').click(function () {
			var json1 = JSON.parse($('#companys').val());
			var json2 = JSON.parse($('#preferences').val());
			var json = {"companys" : json1.companys, "keywords" : json2.keywords};
			$.post("http://localhost:8080/tradeoffParser/webapi/parser/select", json,
				function(data) {
					alert(JSON.stringify(data));
				},
				"json"
			);
		});
	</script>

	<%@  include file="./templates/footer.jsp"%>
</body>
</html>